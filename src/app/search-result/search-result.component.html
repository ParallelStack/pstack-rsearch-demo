<section class="header-pane">
    <div class="row">
        <div class="col-md-2">
            <img src="/assets/logo.png" alt="" height="74px" [routerLink]="['/']">
        </div>
        <div class="col-md-6" style="padding:20px;">
            <form (ngSubmit)="onSearch()">
                <div class="form-group">
                    <div class="input-group">
                        <input id="typeahead-http" type="text" name="search" class="form-control" [(ngModel)]="searchQuery" [ngbTypeahead]="search"
                            placeholder="Search" />
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit">Go!</button>
                        </span>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>

<section style="padding:0px 20px">
    <div class="row">
        <div class="col-md-3 left-pane">
            <div *ngFor="let filter of filters">
                  <ngb-accordion #acc="ngbAccordion">
                    <ngb-panel [title]="">
                            <ng-template ngbPanelTitle>
                                   {{filter.key | uppercase}} ({{filter.doc_count}})
                                  </ng-template>
                      <ng-template ngbPanelContent>
                        <div *ngFor="let item of filter.category_agg.buckets">
                            <label> <input type="checkbox" (click)="filterResult(filter.key, item.key,$event.target.checked)">  {{item.key}} ({{item.doc_count}}) </label>
                        </div>
                      </ng-template>
                    </ngb-panel>
                  </ngb-accordion>

            </div>
            
        </div>
        <div class="col-md-9" style="padding:20px;">
            <div class="pull-right" style="padding:10px 0px;">
                <small>Total {{totalCount}} results found</small>
            </div>

            <div class="row" *ngFor="let r of result" style="margin-bottom:20px;">
                <div class="col-md-2" width="120px">
                    <a [href]="r._source.link" target="_blank">
                        <img [src]="r._source?.thumbnail" width="120px" >
                   </a>
                </div>
                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-12">
                            <a [href]="r._source.link" target="_blank">{{r._source.title}}</a>
                        </div>
                        <div class="col-md-12">
                            {{ (r._source.description.length>6)? (r._source.description | slice:0:500)+'..':(r._source.description) }}
                        </div>
                    </div>
                </div>
            
            </div>

            <div *ngIf="totalCount>20" class="d-flex justify-content-center">
                <ngb-pagination [collectionSize]="totalCount" [pageSize]="20" [ellipses]="false" [rotate]="true" [maxSize]="10" [boundaryLinks]="true"
                    [(page)]="page" (pageChange)="searchResult()" aria-label="Default pagination"></ngb-pagination>
            </div>
        </div>
    </div>
</section>