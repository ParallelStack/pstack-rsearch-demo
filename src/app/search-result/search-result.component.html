<section class="header-pane">
    <div class="row">
        <div class="col-md-2">
            <img src="/assets/logo.png" alt="" height="74px" [routerLink]="['/']">
        </div>
        <div class="col-md-6" style="padding:20px;">
            <app-search-bar [searchQuery]="searchQuery" (onSearchQuery)="onSearchQuery($event)"></app-search-bar>
        </div>
    </div>
</section>

<section style="padding:0px 20px">
    <div class="row">
        <div class="col-md-3 left-pane">
            <div *ngFor="let filter of filters">
                  <ngb-accordion #acc="ngbAccordion" activeIds="static-1">
                    <ngb-panel [title]="" id="static-1">
                            <ng-template ngbPanelTitle>
                                   {{filter.key | uppercase}} ({{filter.doc_count}})
                                  </ng-template>
                      <ng-template ngbPanelContent>
                       <div *ngIf="filter.category_agg.buckets.length>0;else defaultFilter" >
                            <div *ngFor="let item of filter.category_agg.buckets">
                                <label> <input type="checkbox" (change)="filterResult(filter.key, item.key,$event.target.checked)">  {{item.key}} ({{item.doc_count}}) </label>
                            </div>
                       </div>
                       <ng-template #defaultFilter>
                        <label> <input type="checkbox" (change)="filterResult(filter.key,'all' ,$event.target.checked)"> All </label>
                       </ng-template>
                        
                      </ng-template>
                    </ngb-panel>
                  </ngb-accordion>

            </div>
            
        </div>
        <div class="col-md-9" style="padding:20px;">
            <div class="pull-right" style="padding:10px 0px;">
                <small>Total {{totalCount}} results found</small>
            </div>
            <div class="row">
                <div class="col-md-10">
                    <button type="button" class="btn btn-outline-primary" 
                    [class.active]="activeGroup=='products'"
                    (click)="filter('products')" >
                        Products
                      </button>
                      <button type="button" class="btn btn-outline-primary"
                      [class.active]="activeGroup=='news'"
                      (click)="filter('news')">
                        News
                      </button>
                      <button type="button" class="btn btn-outline-primary" 
                      [class.active]="activeGroup=='reviews'"
                      (click)="filter('reviews')">
                        Reviews
                      </button>
                      <button type="button" class="btn btn-outline-primary" 
                      [class.active]="activeGroup=='general'"
                      (click)="filter('general')">
                        General
                      </button>
                      <hr>
                </div>
            </div>

            <div class="row" *ngFor="let r of result" style="margin-bottom:20px; border-bottom:1px solid gary">
                <div class="col-md-2" width="120px">
                    <a [href]="r._source.link" target="_blank">
                        <img [src]="r._source?.thumbnail" width="120px" >
                   </a>
                </div>
                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-12">
                            <a href="" (click)="showDetail(r,$event)" >{{r._source.title}}</a>
                        </div>
                        <div class="col-md-12">
                            {{ (r._source.description.length>6)? (r._source.description | slice:0:500)+'..':(r._source.description) }}
                        </div>
                        <div class="col-md-12" style="margin-top: 10px;" *ngIf="r._source.price" >
                           <strong>Price {{r._source.price | currency:'INR':true}}</strong>
                        </div>
                    </div>
                </div>
            </div>

            <div *ngIf="totalCount>20" class="d-flex justify-content-center">
                <ngb-pagination [collectionSize]="totalCount" [pageSize]="20" [ellipses]="false" [rotate]="true" [maxSize]="10" [boundaryLinks]="true"
                    [(page)]="page" (pageChange)="loadData()" aria-label="Default pagination"></ngb-pagination>
            </div>
        </div>
    </div>
</section>